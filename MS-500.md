 Microsoft 365 Security Administration
 
 
Course concepts 
-	Implement and manage identity and access (30-35%) 
-	Implement and manage threat protection (20-25%) 
-	Implement and manage information protection (15-20%) 
-	Manage governance and compliance features in Microsoft 365 (25-30%) 



# Implement and manage identity and access 
Microsoft Azure have many capabilities that can help protect the organization. These capabilities comes in form of controls. 

### Device controls 
Intune device configuration, are policy controls for devices such as password, Encryption and health. 
Windows Device guard, allows only trusted application which if define by admin. 
Boot secure, Ensure that boot image is validate. 
Azure AD conditional, Allow the controls of only access from managed devices.
	
### Email controls
That are many ways an attack can gain access to the organization by sending malicious emails [[Social engineering]]. Microsoft have multiple controls to help protect against these kind of attacks. **Exchange Online protection** scan the emails attachment and url for any malicious intend.  **Office 365 Advance threat protection** and **Windows defender smartScreen** are protection controls after the email have been delivered. Advance threat protection protect the user against link and files if the user click on them and there malware, and stop the application before the malware is delivered. SmartScreen is a warning to the user of potentiate malware. 


### User controls
User account is critical they are protected as they are the way employee [[Authentication]] and [[Authorization]] to the organization and the resources they need access too, for this reason multiple controls have been created to help protect user. [[MFA]] can be setup ensuring that stealing the password is not enough, to gain access. **Azure AD password protection** are the policy for passwords with controls to password requirement, force password reset on leaked passwords. **Azure AD Smart Account Lockout** are controls for when account should be locked when high-risk activity occurs. 

#### User risk policy 
The User risk policy it the control of how to handle people with is caracteres as potentially compromised within a rank of low, medium and high. The policy allows for either blocking a user access based on the risk or forcing the user to change password and there by mitigating the risk of compromise. 
When auditing user risk, it possible to set the alert to true or false positive. The more risks you audit the better the system get a rating further risk alerts base on machine learning
	
### Malware Controls
Application installed on machines can include malware in form of virus, spyware, ransomware, etc. here controls such as **Device guard** can help by only allowing trusted application which is defined by the organization. **Windows defender Antivirus** is 365 [[anti-virus]].**Windows Firewall** [[Firewall]] protect against unauthorized access. 
	
### Lateral movement 
If Attacker gain access to a device lateral movement control have to be put in place to ensure that the attack does not spread to other systems. **Cloud app Security** alerts on activity is deems suspicious. **Credential Guard** prevents attack from gaining access to other resource using method Pass-the-hash or Pass-the-Ticket.
	
###  Data exfiltration
To help organization to protect their data, Microsoft have create controls to classify and encrypt the data. **Windows information protection** protect files with encryption to limit data leakages. **Exchange mail flow rules** help prevent forwarding rules to external domains. **Azure Information Protection and Azure
Rights Management**  encrypts and permissions sensitive files. Protection travels with the files. **Azure technologies** provide encryption for disks and storage, SQL Encryption, and Key vault. *SQL Database dynamic data masking* limits sensitive data exposure by masking it to non-privileged users. **SQL Threat Detection** alerts on suspicious database activities, potential vulnerabilities, and SQL injection attacks, as well as anomalous database access patterns. **Azure Backup** is a service you can use to back up and restore your data in the Microsoft cloud. This service includes capabilities to protect your backups from ransomware. 
	
	
	
## Deployment plan 
### Authentication	
The plan for how user will [[Authentication]] to the organization is important to ensure that legit user have access the resources they need, while also keeping all other out. [[MFA]] controls can be put in place to protect the user in [[Brute force]], leaked, etc. **Conditional access** is a conditional control for who can access cloud app. If you want the organization to be event more protected passwordless deployment using Authenticator app or FIDO2 Security key, this is also a benefit for user as they no longer have to remember passwords. 

|Bad|Good|Better|Best|
|---|---|---|---|
|weak password|sms| Microsoft auth|Windows hello|
||Voice|Software token OTP| Microsoft authn sign in|
|||Hardware token OTP| FIDO2 security key|

### Application and device 
When deploying application how user should [[Authentication]] to the application is important, an good option is [[SSO]], help the user by not having to type in the password multiple times. 

### Governance and reporting
**Privileged Identity Management** Is a administration tools for roles, It have controls such as [[Just-in-time]] access. access review that can help review access to resources. 

### Privileged Identity Management
The purpose of Privileged Identity Management (PIM) to to minimize the number of users that have access to information or resources. 
PIM is a tools in azure AD to mange azure role access, and notify when a role is activated. There are multiple time and approval based controls in PIM to mange the access to role, one such thing is [[Just-in-time]] access, access review, access justification, the requirement for MFA and many more. 
Everything get logged in the azure audit logs allowing the admin to review history. 
It is Microsoft recommendation to implement the roles with a most to least access priority. 
It is recommended to read through all audit events on weekly basis and export the event on a monthly basis. 

### Azure AD connect sync
Takes care of syncing [[AD]] data between the Azure AD and on-premise environment. 


### Azure Active Directory Connect health 
Send email notification when the Azure Ad health status decrease 

### Dynamic membership rules for groups in azure AD
Allows the administrator to dynamically handle roles depending on conditions of either the users or devices, setup by the administrator. 
The system change the system or user each time the attributes get updated to check if any roles need to be added or removed. 

### Azure AD Self-service password reset 
GIves user the ability to change their password without help from service desk or administrator. Admin of the Azure AD have the option to enable self-service of password change. during this process the admin can setup what authentication method are available and how many is required to be allowed to reset one password. The option is between 1 or 2. It also possible to setup email notification when a user password is changed they receive a mail notifying them their password have been changed. Equally it possible for admin to be notified with an admin have reset their password. 
Unlocking of the account can also be done through self-service following the same method as reset password. 


### Azure AD access review
Allow organization to manage group memberships. This is important when it comes to user that switch team or guest account, ensuring they only have access as long as they need it. With access review control administrator can put the responsibility of the group management to the group owner. Beside group owner you can also assign it to specific user or self-review. 

### Azure AD [[MFA]]
Multi-Factor Authentication is an additional safe guard to user. **Conditional Access** is used to configuration when user need to provide MFA, which user is effected by the policy, there also the conditional for user not needing to use MFA from trusted location.  
Conditional access policies can be setup to require password reset, in case of high risk sign-in or if Azure have defines the user as a high risk of compromise. 

### Passwordless [[Authorization]] implementation 
Authentication methods policy is where admin have the ability to roll out [[FIDO2]] and Microsoft authenticator to both selected user and all user. For Microsoft authenticator to be used as passwordless, MFA need to be enabled. 
It possible to require people to register for both MFA and self-service at registration point. 

### Azure reports & logs
Using Azure AD portal, administrators have the ability to see the logs of user sign-ins and if MFA was used or not. It a good way to get any indication how MFA configuration have effected the organization. 
Azure also give Risk reports, which comes in two varies Risky user, which is user Azure presumes are compromised, and risky sign-ins which it sign of user sign-in which Azure deems to be risky this could be a new sign-in location. 



### Manage user authentication methods 
Azure AD portal allows administrator to manage user [[MFA]], With tools such as disable devices, require user to provide contact methods, add multi-factor by providing phone number.


### Emergency account
When starting to configure **Conditional access** policies it important to have admin account that are excepted from access policies, ensuring that there is always access to the Azure in case if policies get configured in such a way that lock out the access for user. In these cases the *emergency account* will be used to reconfigure the policies giving access to the domain again to the users. 

### Intune
Where Conditional access is policies related to the connection, eg. Location, User, MFA, Risk etc. Intune is policies related to the device used to connect to the organization. And if the device is compliance with the organization requirement. e.g Latest security update, Anti-virus, etc.

### managed devices 
Are devices that is under the organization control, by either being domain joined, or hybrid Azure AD joined, when setting access control to only manage devices but not tell is the GPO have been applied to the devices. An way to help with this is by requiring the devices to be marked as compliant, Intune can be used to validate that the device is compliance.


### Azure RBAC 
Role base access control of how permissions are enforced. an role consists of three elements : security principal, role definition and scope.  
Security principal is who the target this can be a user, group service principal or manged identity. Role is what they are allow to do, read, write, etc. And scope is what resources the access control applies to. 
Admins in Azure allows for assignment of roles to users. In Azure admin role is split up by product (eg. Exchange admin, User admin, Office admin, ATP admin, etc. ) allowing user to only be admin of a particular product. It important to note that only admin can reset another admin accounts. for that reason there should be more then one global admin account, in case of compromise and lost of password. 


### Azure logs 
Azure activity logs are stored for up 90 days. The activity log can be view in two ways with the web interface on azure under resource group -> activity log, the log file can also be downloaded as a csv file.  The other option is to use Azure power shell with the Get-AzLog command.

# Implement and manage threat protection 

### Azure ATP 
Azure ATP is a security cloud-based tools which uses the signals from [[AD]] to identify, detect and investigate advance threats. It also have the possibility to protect user by creating a baseline for each user, can alerting when deviation occurs from the baseline, that is view as potential risk. AD FS protection by detecting attacks and providing visibility into authentication events generated by the AD FS. Identifying rogue user and attacks. Lateral movement detection. And security recommendation to improve the network security. 